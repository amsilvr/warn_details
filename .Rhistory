tempfile()
dir(tempfile())
greet <- function(name) {
"How do you do, name?"
}
greet(Aaron)
greet <- function(name) {
paste0("How do you do,",name, "?")
}
greet(Aaron)
greet("Aaron")
greet <- function(name) {
glue::glue("How do you do, {name}?")
}
greet("Aaron")
library(tidyverse)
df1 <- tibble(x = 1:3)
a <- 10
mutate_y(df1)
mutate_y <- function(df){
mutate(df, y = a + x)
}
mutate_y(df1)
mutate_y2 <- function(df){
mutate(df, y = .data$a + .data$x)
}
mutate_y2(df1)
df <- tibble(
g1 = c(1,1,2,2,2),
g2 = c(1,2,1,2,1),
a = sample(5),
b = sample(5)
)
df
df %>%
group_by(g1) %>%
summarize(a = mean(a))
my_summarize <- function(df, group_var){
df %>%
group_by(group_var) %>%
summarize(a = mean(a))
}
my_summarize(df, g1)
quo(g1)
quo(a + b + c)
my_summarize <- function(df, group_var){
df %>%
group_by(!!group_var) %>%
summarize(a = mean(a))
}
my_summarize(df, g1)
my_summarize(df, quo(g1))
enquo
my_summarize <- function(df, group_var){
group_by <- enquo(group_by)
print(group_by)
df %>%
group_by(!!group_var) %>%
summarize(a = mean(a))
}
my_summarize(df, g1)
my_summarize <- function(df, group_var){
group_by <- enquo(group_by)
print(group_by)
df %>%
group_by(!!group_by) %>%
summarize(a = mean(a))
}
my_summarize(df, g1)
my_summarize <- function(df, group_by){
group_by <- enquo(group_by)
print(group_by)
df %>%
group_by(!!group_by) %>%
summarize(a = mean(a))
}
my_summarize(df, g1)
summarize(df, mean = mean(a), sum = sum(a), n = n())
summarize(df, mean = mean(a * b), sum = sum(a * b), n = n())
my_var <- quo(a)
summarize(df, mean = mean(!!my_var), sum = sum(!!my_var), n = n())
quo(summarize(df,
mean = mean(!!my_var),
sum = sum(!!my_var),
n = n())
)
my_summarize2 <- function(df, expr){
expr <- enquo(expr)
summarize(df,
mean = mean(!!expr),
sum = sum(!!expr),
n = n())}
my_summarize2(df, a*b)
my_summarize2(df, a)
mutate(df, mean_a = mean(a), sum_a = sum(a))
mutate(df, mean_b = mean(b), sum_b = sum(b))
library(rlang)
my_mutate <- function(df, expr){
expr <- enquo(expr)
mean_name <- paste0("mean_",quo_name(expr))
sum_name <- paste0("sum_",quo_name(expr))
mutate(df,
!!mean_name := mean(!!expr),
!!sum_name := sum(!!expr)
)
}
my_mutate(df, a)
my_mutate(df, b)
my_mutate(df, a*b)
my_summarize3 <- function(df, ...){
group_by <- quos(...)
df %>%
group_by(!!!group_by) %>%
summarize(a = mean(a))
}
my_summarize3(df, g1, g2)
?`!!!`
args <- list(na.rm = TRUE, trim = .25)
quo(mean(x, !!! args))
args
args <- list(quo(x), na.rm = TRUE, trim = .25)
args
quo(mean(!!! args))
disp ~ cyl + drat
disp
toupper(letters[1:5])
quote(toupper(letters[1:5]))
f <- function(x){quo(x)}
x1 <- f(10)
x1
x2 <- f(100)
x2
get_env(x1)
get_env(x2)
eval_tidy(x1)
eval_tidy(x2)
user_var <- 1000
mtcars %>% summarize(cyl = mean(cyl) + user_var)
mtcars %>% summarize(cyl = mean(cyl) * user_var)
var <- ~toupper(letters[1:5])
var
get_expr(var)
get_env(var)
quo(toupper(letters[1:5]))
quo(toupper(!!letters[1:5]))
quo(toupper(UQ(letters[1:5])))
my_mutate <- function(x) {
mtcars %>%
select(cyl) %>%
slice(1:4) %>%
mutate(cyl2 = cyl + (!! x))
}
my_mutate(4)
my_mutate(15)
f <- function(x) quo(x)
expr1 <- f(100)
expr1
expr2 <- f(10)
my_mutate(expr1)
my_mutate(expr2)
quo(filter(df, UQE(my_var) == 1))
x <-  y
install.packages("tibble")
install.packages
?install.packages
getOption("repos")
?setRepositories
R.home()
edit(paste0(R.home(),"etc/repositories"))
install.packages("tidyverse")
library(tibble)
tribble(~Film, ~Year, "A New Hope", 1977, "Empire Strikes back", 1980, "
Return of the Jedi", 1983)
tribble(~Film, ~Year, "A New Hope", 1977, "Empire Strikes back", 1980, "Return of the Jedi", 1983)
tibble(~Film, ~Year, "A New Hope", 1977, "Empire Strikes back", 1980, "Return of the Jedi", 1983)
as_tibble(mtcars)
quantiles <- quantile(mtcars$hp, probs ~ c(.1,.25,.5,.75,.9))
quantiles <- quantile(mtcars$hp, probs = c(.1,.25,.5,.75,.9))
quantiles
enframe(quantiles, "quantile", "value")
df <- as.data.frame(replicate(16,2:200))
df
df %>% setNames(letters)
library(tidyverse)
df %>% setNames(letters)
df <- as.data.frame(replicate(26,1:200))
head(df)
df %>% setNames(letters)
df %>% as_tibble()
df <- df %>% setNames(letters) %>% as_tibble()
df
glimpse(df)
df <- tibble(comment = "original", x = 1:2, x_squared = x ^ 2)
df
df <- df %>%
add_row(comment = "append", x = 3:4, x_squared = x^2) %>%
add_row(comment = "prepend", x = 0, x_squared = x^2, .before = 1)
df
as_tibble(mtcars)
mtcars %>% as_tibble() %>% rownames_to_column("model")
voice.part
??voice.part
library("installr", lib.loc="C:/Program Files/R/R-3.4.1/library")
installr::check.for.updates.R()
library(sf)
library(tidyverse)
install.packages("tidyverse")
library(tidyverse)
library(sf)
countyshapes_url <- "http://www2.census.gov/geo/tiger/GENZ2016/shp/cb_2016_us_county_20m.zip"
if (!dir.exists("data")) {dir.create("data")}
if (!file.exists("data/county_shape_file.zip")) {
download.file(countyshapes_url
, destfile = "data/county_shape_file.zip")}
getwd()
dir()
setwd('Data_Science/warn_details')
countyshapes_url <- "http://www2.census.gov/geo/tiger/GENZ2016/shp/cb_2016_us_county_20m.zip"
if (!dir.exists("data")) {dir.create("data")}
if (!file.exists("data/county_shape_file.zip")) {
download.file(countyshapes_url
, destfile = "data/county_shape_file.zip")}
c_shp <- unzip("data/county_shape_file.zip", exdir = "data")
counties_sf <- read_sf(c_shp[grep("shp$", c_shp)]) %>% #pulls the shp file from the zip
left_join(state_iso) %>%
st_transform('+proj=longlat +datum=WGS84') %>%
inner_join(lsad_lookup())
state.name
state.abb
state.division
state.x77
counties_sf <- read_sf(c_shp[grep("shp$", c_shp)])
state_iso <- read_csv("https://www2.census.gov/geo/docs/reference/codes/files/national_county.txt"
, col_names = c("iso_3166_2"
, "STATEFP"
, "COUNTYFP"
, "name","x")) %>%
select(2,1) %>%
unique()
install.packages("curl")
library(curl)
state_iso <- read_csv("https://www2.census.gov/geo/docs/reference/codes/files/national_county.txt"
, col_names = c("iso_3166_2"
, "STATEFP"
, "COUNTYFP"
, "name","x")) %>%
select(2,1) %>%
unique()
state_iso
counties_sf <- counties_sf %>% select(1,2,5,6,7)
left_join(counties_sf, state_iso)
names(state_iso)
names(counties_sf)
left_join(as.data.frame(counties_sf), state_iso)
getwd()
dir()
source('C:/Users/amsilverman/Box Sync/@Project Support/Data_Science/warn_details/CMAS_Clean_shiny.R')
counties_sf <- read_sf(c_shp[grep("shp$", c_shp)]) %>%
as.data.frame() %>% #to fix July 25 problem with the join.sf methods
left_join(state_iso) %>%
inner_join(lsad_lookup())
class(counties_sf)
?st_transform
counties_sf <- read_sf(c_shp[grep("shp$", c_shp)]) %>%
as.data.frame() %>% #to fix July 25 problem with the join.sf methods
left_join(state_iso) %>%
inner_join(lsad_lookup()) %>%
sf() %>%
st_transform('+proj=longlat +datum=WGS84') %>%
counties_sf$NAME <- str_replace_all(counties_sf$NAME, pattern = "ÃƒÂƒÃ‚Â±",replacement = "ÃƒÂ±") %>%
str_replace_all("ÃƒÂƒÃ‚Â¡",replacement = "ÃƒÂ¡") %>%
str_replace_all("ÃƒÂƒÃ‚Â¼",replacement = "ÃƒÂ±") %>%
str_replace_all("ÃƒÂƒÃ‚Â³",replacement = "ÃƒÂ³") %>%
str_replace_all("ÃƒÂƒ",replacement = "Ãƒ­")
counties_sf <- read_sf(c_shp[grep("shp$", c_shp)]) %>%
as.data.frame() %>% #to fix July 25 problem with the join.sf methods
left_join(state_iso) %>%
inner_join(lsad_lookup())
names(counties_sf)
counties_sf <- read_sf(c_shp[grep("shp$", c_shp)]) %>%
as.data.frame() %>% #to fix July 25 problem with the join.sf methods
left_join(state_iso) %>%
inner_join(lsad_lookup()) %>%
select(STATEFP, COUNTYFP, GEOID, NAME, description, iso_3166_2, geometry) %>%
st_sf(crs = '+proj=longlat +datum=WGS84') %>%
counties_sf$NAME <- str_replace_all(counties_sf$NAME, pattern = "ÃƒÂƒÃ‚Â±",replacement = "ÃƒÂ±") %>%
str_replace_all("ÃƒÂƒÃ‚Â¡",replacement = "ÃƒÂ¡") %>%
str_replace_all("ÃƒÂƒÃ‚Â¼",replacement = "ÃƒÂ±") %>%
str_replace_all("ÃƒÂƒÃ‚Â³",replacement = "ÃƒÂ³") %>%
str_replace_all("ÃƒÂƒ",replacement = "Ãƒ­")
counties_sf <- read_sf(c_shp[grep("shp$", c_shp)]) %>%
as.data.frame() %>% #to fix July 25 problem with the join.sf methods
left_join(state_iso) %>%
inner_join(lsad_lookup()) %>%
select(STATEFP, COUNTYFP, GEOID, NAME, description, iso_3166_2, geometry) %>%
st_sf(crs = '+proj=longlat +datum=WGS84')
counties_sf <- read_sf(c_shp[grep("shp$", c_shp)]) %>%
as.data.frame() %>% #to fix July 25 problem with the join.sf methods
left_join(state_iso) %>%
inner_join(lsad_lookup()) %>%
select(STATEFP, COUNTYFP, GEOID, NAME, description, iso_3166_2, geometry) %>%
st_sf() %>%
st_transform('+proj=longlat +datum=WGS84') %>%
counties_sf$NAME <- str_replace_all(counties_sf$NAME, pattern = "ÃƒÂƒÃ‚Â±",replacement = "ÃƒÂ±") %>%
str_replace_all("ÃƒÂƒÃ‚Â¡",replacement = "ÃƒÂ¡") %>%
str_replace_all("ÃƒÂƒÃ‚Â¼",replacement = "ÃƒÂ±") %>%
str_replace_all("ÃƒÂƒÃ‚Â³",replacement = "ÃƒÂ³") %>%
str_replace_all("ÃƒÂƒ",replacement = "Ãƒ­")
counties_sf <- read_sf(c_shp[grep("shp$", c_shp)]) %>%
as.data.frame() %>% #to fix July 25 problem with the join.sf methods
left_join(state_iso) %>%
inner_join(lsad_lookup()) %>%
select(STATEFP, COUNTYFP, GEOID, NAME, description, iso_3166_2, geometry) %>%
st_sf() %>%
st_transform('+proj=longlat +datum=WGS84')
class(counties_sf)
counties_sf$NAME <-
str_replace_all(counties_sf$NAME, pattern = "ÃƒÂƒÃ‚Â±",replacement = "ÃƒÂ±") %>%
str_replace_all("ÃƒÂƒÃ‚Â¡",replacement = "ÃƒÂ¡") %>%
str_replace_all("ÃƒÂƒÃ‚Â¼",replacement = "ÃƒÂ±") %>%
str_replace_all("ÃƒÂƒÃ‚Â³",replacement = "ÃƒÂ³") %>%
str_replace_all("ÃƒÂƒ",replacement = "Ãƒ­")
shiny::runApp()
install.packages('shinycssloader')
library(shinycssloader)
library(devtools)
devtools::install_github('andrewsali/shinycssloaders')
?devtools
getOption(devtools)
getOption(devtools.path)
getOption('devtools.path')
getOption('path.expand')
options()
install.packages("DT")
library(DT)
datatable(iris)
runApp()
